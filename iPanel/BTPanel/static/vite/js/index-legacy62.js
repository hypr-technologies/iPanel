System.register(["./public-legacy.js?v=1752142539265","./index-legacy102.js?v=1752142539265","./index-legacy.js?v=1752142539265","./index.vue_vue_type_script_setup_true_lang-legacy4.js?v=1752142539265","./vue-legacy.js?v=1752142539265","./page_layout-legacy.js?v=1752142539265","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1752142539265","./index.vue_vue_type_script_setup_true_lang-legacy9.js?v=1752142539265","./naive-legacy.js?v=1752142539265","./index.vue_vue_type_script_setup_true_lang-legacy5.js?v=1752142539265","./common-legacy.js?v=1752142539265","./__commonjsHelpers__-legacy.js?v=1752142539265","./index.vue_vue_type_script_setup_true_lang-legacy7.js?v=1752142539265","./index-legacy96.js?v=1752142539265"],(function(e,t){"use strict";var a,n,l,i,s,o,u,d,c,r,p,_,y,m,g,x,h,f,v,w,b,k,S,I,A,$,C,U,H,j,R,q,L,O,P,T,z,M,D,K,B,W,X,E,F,N,Q,V,Z,G,J,Y,ee,te,ae,ne,le,ie;return{setters:[e=>{a=e.b,n=e.h,l=e.c,i=e.e,s=e._,o=e.f,u=e.K,d=e.a,c=e.r},e=>{r=e._},e=>{p=e._},e=>{_=e._},e=>{y=e.k,m=e.P,g=e.r,x=e.e,h=e.U,f=e.X,v=e.Q,w=e.W,b=e.a2,k=e.V,S=e.a3,I=e.ah,A=e.j,$=e.N,C=e.$,U=e.w,H=e.F,j=e.a1,R=e.l,q=e.O,L=e.H,O=e.v,P=e.c},e=>{T=e.v,z=e.i,M=e.d,D=e.p,K=e.e,B=e.w,W=e.cz,X=e.m,E=e.x,F=e._,N=e.u},e=>{Q=e._},e=>{V=e._},e=>{Z=e.cz,G=e.cD,J=e.aq,Y=e.ay,ee=e.bZ,te=e.bX,ae=e.cA,ne=e.bA,le=e.c1},e=>{ie=e._},null,null,null,null],execute:function(){var t=document.createElement("style");t.textContent=".form[data-v-201446e2] .n-form-item{margin-right:5px!important}.form[data-v-201446e2] .n-form-item-label{width:auto!important;padding:5px!important}.ul-style[data-v-f55518e2]{margin:0 auto;display:flex;align-items:center;justify-content:center;gap:48px;font-size:16px}.ul-style li[data-v-f55518e2]{display:flex;align-items:center}.item[data-v-f55518e2]{border-left:3px solid #def2e2}.item li[data-v-f55518e2]{width:180px;margin-left:-3px;font-size:14px;line-height:36px;padding:0 20px;cursor:pointer}.item .active[data-v-f55518e2]{border-left:3px solid #20a53a;color:#20a53a;font-weight:700;font-size:16px}\n/*$vite$:1*/",document.head.appendChild(t);const{t:se}=z.global,oe=e=>T.post("/plugin?name=syssafe&action=a&s=set_safe_status",e,{requestOptions:{loading:se("Security.Api.Index_5"),successMessage:!0}}),ue=e=>T.post("/plugin?name=syssafe&action=a&s=remove_safe_path",e,{requestOptions:{loading:se("Security.Api.Index_3"),successMessage:!0}}),de=e=>T.post("/plugin?name=syssafe&action=a&s=add_safe_path",e,{requestOptions:{loading:se("Security.Api.Index_4"),successMessage:!0}}),ce=e=>T.post("/plugin?name=syssafe&action=a&s=add_ssh_limit",e,{requestOptions:{loading:se("Security.Api.Index_4"),successMessage:!0}}),re=e=>T.post("/plugin?name=syssafe&action=a&s=remove_ssh_limit",e,{requestOptions:{loading:se("Security.Api.Index_3"),successMessage:!0}}),pe=e=>T.post("/plugin?name=syssafe&action=a&s=save_ssh_config",e,{requestOptions:{loading:se("Security.Api.Index_6"),successMessage:!0}}),_e=e=>T.post("/plugin?name=syssafe&action=a&s=remove_process_white",e,{requestOptions:{loading:se("Security.Api.Index_3"),successMessage:!0}}),ye=e=>T.post("/plugin?name=syssafe&action=a&s=add_process_white",e,{requestOptions:{loading:se("Security.Api.Index_4"),successMessage:!0}}),me={class:"p-20px"},ge=y({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=m(),n=[{label:a("Security.Anti.Index_28"),value:"i"},{label:a("Security.Anti.Index_29"),value:"a"}],l=e,{getList:i}=l.data,{row:s}=l.data,o=g(null),u=x({path:"",chattr:"i",d_mode:""}),d={path:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]},d_mode:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{await(o.value?.validate()),await de({...u,s_key:s.key}),i?.(),e()}}),(e,t)=>{const a=V,l=Z,i=G,s=J,c=Q;return f(),h("div",me,[v(c,{ref_key:"formRef",ref:o,model:w(u),rules:d},{default:b((()=>[v(l,{label:e.$t("Site.DelSite.index_2"),path:"path"},{default:b((()=>[v(a,{class:"w-280px",value:w(u).path,"onUpdate:value":t[0]||(t[0]=e=>w(u).path=e),placeholder:e.$t("Security.Anti.Index_26")},null,8,["value","placeholder"])])),_:1},8,["label"]),v(l,{label:e.$t("Security.Hardening.Index_8")},{default:b((()=>[v(i,{class:"w-280px",value:w(u).chattr,"onUpdate:value":t[1]||(t[1]=e=>w(u).chattr=e),options:n},null,8,["value"])])),_:1},8,["label"]),v(l,{label:e.$t("Security.Hardening.Index_9"),path:"d_mode"},{default:b((()=>[v(s,{class:"w-280px!",value:w(u).d_mode,"onUpdate:value":t[2]||(t[2]=e=>w(u).d_mode=e),type:"text",placeholder:e.$t("Security.Anti.Index_27")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),xe={class:"p-20px"},he=y({__name:"index",props:{data:{}},setup(e){const{t:t}=m(),u=e,{data:d}=u,{keys:c,table:r,columns:y}=a([{key:"path",title:t("Site.DelSite.index_2")},{key:"chattr",title:t("Security.Hardening.Index_8"),render:e=>"i"==e.chattr?t("Security.Anti.Index_28"):t("Security.Anti.Index_29")},{key:"s_mode",title:t("Security.Hardening.Index_9"),render:e=>e.s_mode!==e.d_mode?`${e.s_mode} >> ${e.d_mode}`:e.d_mode},{key:"state",title:t("Config.Safe.index_156"),render:e=>v("span",{style:{color:e.state?"#20a53a":"#ff0029"}},[e.state?t("Security.Anti.Index_35"):t("Security.Anti.Index_36")])},n({width:130,title:t("Public.Table.Operation"),options:e=>[{label:t("Public.Btn.Del"),onClick:async()=>{await ue({s_key:d.key,path:e.path}),await C()}}]})]),g=async()=>{U.data.row=d,U.show=!0},{loading:x,setLoading:$}=l(),C=async()=>{try{$(!0);const{message:e}=await(e=>T.post("/plugin?name=syssafe&action=a&s=get_safe_config",e))({s_key:d.key});M(e)&&(r.data=e.paths)}finally{c.value=[],$(!1)}};C();const U=i(t("Security.Anti.Index_30"),{getList:C});return(e,t)=>{const a=Y,n=o,l=s,i=_,u=p;return f(),h("div",xe,[v(i,null,{toolsLeft:b((()=>[v(a,{type:"primary",onClick:g},{default:b((()=>[A(S(e.$t("Security.Anti.Index_30")),1)])),_:1})])),table:b((()=>[v(n,{"checked-row-keys":w(c),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>I(c)?c.value=e:null),loading:w(x),"loading-num":3,"max-height":340,data:w(r).data,columns:w(y)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:b((()=>[v(l,null,{default:b((()=>[k("li",null,S(e.$t("Security.Anti.Index_31")),1),k("li",null,S(e.$t("Security.Anti.Index_32")),1),k("li",null,S(e.$t("Security.Anti.Index_33")),1),k("li",null,S(e.$t("Security.Anti.Index_34")),1)])),_:1})])),_:1}),v(u,{show:w(U).show,"onUpdate:show":t[1]||(t[1]=e=>w(U).show=e),title:w(U).title,data:w(U).data,width:500,footer:!0,component:ge},null,8,["show","title","data"])])}}}),fe={class:"p-20px"},ve={class:"leading-32px"},we=y({__name:"index",setup(e){const{t:t}=m(),a=g(null),n=x({cycle:120,limit_count:3,limit:3600}),l={cycle:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]},limit_count:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]},limit:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]}},i=async()=>{await(a.value?.validate()),await pe($(n))};return(async()=>{const{message:e}=await T.post("/plugin?name=syssafe&action=a&s=get_ssh_config");M(e)&&(n.cycle=e.cycle,n.limit=e.limit,n.limit_count=e.limit_count)})(),(e,t)=>{const o=ee,u=Z,d=Y,c=Q,r=D,p=s;return f(),h("div",fe,[v(c,{ref_key:"formRef",ref:a,model:w(n),rules:l,inline:"","label-width":"auto",class:"form"},{default:b((()=>[v(u,{label:e.$t("Security.Anti.Index_37"),path:"cycle"},{default:b((()=>[v(o,{"show-button":!1,value:w(n).cycle,"onUpdate:value":t[0]||(t[0]=e=>w(n).cycle=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),v(u,{label:e.$t("Security.Anti.Index_38"),path:"limit_count"},{default:b((()=>[v(o,{"show-button":!1,value:w(n).limit_count,"onUpdate:value":t[1]||(t[1]=e=>w(n).limit_count=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),v(u,{label:e.$t("Security.Anti.Index_39"),path:"limit"},{default:b((()=>[v(o,{"show-button":!1,value:w(n).limit,"onUpdate:value":t[2]||(t[2]=e=>w(n).limit=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),k("span",ve,S(e.$t("Security.Anti.Index_40")),1),v(d,{type:"primary",class:"ml-auto",onClick:i},{default:b((()=>[A(S(e.$t("Site.Cert.index_60")),1)])),_:1})])),_:1},8,["model"]),v(r,{class:"mb-15px!"}),v(p,null,{default:b((()=>[k("li",null,S(e.$t("Security.Anti.Index_41")),1),k("li",null,S(e.$t("Security.Anti.Index_42")),1),k("li",null,S(e.$t("Security.Anti.Index_43")),1)])),_:1})])}}}),be=K(we,[["__scopeId","data-v-201446e2"]]),ke={class:"p-20px"},Se=y({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=m(),n=e,{getList:l}=n.data,i=g(null),s=x({process_name:""}),o={process_name:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{await(i.value?.validate()),await ye($(s)),l?.(),e()}}),(e,t)=>{const a=J,n=Z,l=Q;return f(),h("div",ke,[v(l,{ref_key:"formRef",ref:i,model:w(s),rules:o},{default:b((()=>[v(n,{label:e.$t("Home.index_24"),path:"process_name"},{default:b((()=>[v(a,{class:"w-280px!",value:w(s).process_name,"onUpdate:value":t[0]||(t[0]=e=>w(s).process_name=e),type:"text",placeholder:e.$t("Security.Anti.Index_22")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),Ie={class:"p-20px"},Ae=y({__name:"index",setup(e){const{t:t}=m(),{keys:u,table:d,columns:c}=a([{key:"name",title:t("Home.index_24")},n({width:130,title:t("Public.Table.Operation"),options:e=>[{label:t("Public.Btn.Del"),onClick:async()=>{await _e({process_name:e.name}),await x()}}]})]),r=async()=>{$.show=!0},{loading:y,setLoading:g}=l(),x=async()=>{try{g(!0);const{message:e}=await T.post("/plugin?name=syssafe&action=a&s=get_process_white");B(e)&&(d.data=e.map((e=>({name:e}))))}finally{u.value=[],g(!1)}};x();const $=i(t("Security.Anti.Index_23"),{getList:x});return(e,t)=>{const a=Y,n=o,l=s,i=_,m=p;return f(),h("div",Ie,[v(i,null,{toolsLeft:b((()=>[v(a,{type:"primary",onClick:r},{default:b((()=>[A(S(e.$t("Security.Anti.Index_23")),1)])),_:1})])),table:b((()=>[v(n,{"checked-row-keys":w(u),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>I(u)?u.value=e:null),loading:w(y),"loading-num":3,"max-height":340,data:w(d).data,columns:w(c)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:b((()=>[v(l,null,{default:b((()=>[k("li",null,S(e.$t("Security.Anti.Index_24")),1),k("li",null,S(e.$t("Security.Anti.Index_25")),1)])),_:1})])),_:1}),v(m,{show:w($).show,"onUpdate:show":t[1]||(t[1]=e=>w($).show=e),title:w($).title,data:w($).data,width:500,footer:!0,component:Se},null,8,["show","title","data"])])}}}),$e={class:"color-#ff3333"},Ce=y({__name:"index",setup(e,{expose:t}){const{t:d}=m(),c=W(),{systemHardening:r}=C(c),y=i(),g=i(),x=i(),{keys:A,table:$,columns:j}=a([{key:"name",width:"10%",title:d("Site.TableRow.index_2")},{key:"ps",title:d("Security.Hardening.Index_5"),ellipsis:{tooltip:{width:"trigger"}}},u({key:"open",title:d("Site.TableRow.index_14"),onClick:async(e,t)=>{if(!r.value)return X.error(d("Security.Hardening.Index_6")),void L();await oe({s_key:t.key})}}),n({width:130,title:d("Site.TableRow.index_30"),options:e=>[{label:d("Site.TableOP.index_3"),onClick:()=>"ssh"===e.key?(g.title=`${d("Security.Hardening.Index_7")} [${e.name}]`,void(g.show=!0)):"process"===e.key?(x.title=`${d("Security.Hardening.Index_7")} [${e.name}]`,void(x.show=!0)):(y.title=`${d("Security.Hardening.Index_7")} [${e.name}]`,y.data=e,void(y.show=!0))}]})]);U((()=>c.isRefresh),(e=>{e&&(c.setRefresh(!1),L())}));const{loading:R,setLoading:q}=l(),L=async()=>{try{q(!0);const{message:e}=await T.post("/plugin?name=syssafe&action=a&s=get_safe_status");M(e)&&(r.value=e.open,$.data=e.list)}finally{A.value=[],q(!1)}};return L(),t({init:L}),(e,t)=>{const a=o,n=_,l=s,i=p;return f(),h(H,null,[v(n,{feedback:!0},{table:b((()=>[v(a,{"checked-row-keys":w(A),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>I(A)?A.value=e:null),"row-key":"title",loading:w(R),data:w($).data,columns:w(j)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),v(l,{class:"mt-16px"},{default:b((()=>[k("li",null,S(e.$t("Security.Hardening.Index_1")),1),k("li",null,S(e.$t("Security.Hardening.Index_2")),1),k("li",null,S(e.$t("Security.Hardening.Index_3")),1),k("li",$e,S(e.$t("Security.Hardening.Index_4")),1)])),_:1}),v(i,{show:w(y).show,"onUpdate:show":t[1]||(t[1]=e=>w(y).show=e),title:w(y).title,data:w(y).data,width:700,"min-height":500,footer:!1,component:he},null,8,["show","title","data"]),v(i,{show:w(g).show,"onUpdate:show":t[2]||(t[2]=e=>w(g).show=e),title:w(g).title,data:w(g).data,width:800,footer:!1,component:be},null,8,["show","title","data"]),v(i,{show:w(x).show,"onUpdate:show":t[3]||(t[3]=e=>w(x).show=e),title:w(x).title,data:w(x).data,width:700,"min-height":580,footer:!1,component:Ae},null,8,["show","title","data"])],64)}}}),Ue=y({__name:"index",setup(e,{expose:t}){const{t:i}=m(),{loading:u,setLoading:d}=l(),c=g(""),r=/^(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])$/,{keys:p,table:y,columns:x}=a([{key:"address",title:i("Security.Anti.Index_15"),width:"70%"},{key:"end",title:i("Security.History.Index_12"),render:e=>0==e.end?i("Security.Anti.Index_18"):e.end},n({width:130,title:i("Site.TableRow.index_30"),options:e=>[{label:i("Security.Anti.Index_19"),onClick:async()=>{await re({ip:e.address}),C()}}]})]),$=async()=>{r.test(c.value)?(await ce({ip:c.value}),C(),c.value=""):X.error(i("Security.Anti.Index_20"))},C=async()=>{try{d(!0);const{message:e}=await T.post("/plugin?name=syssafe&action=a&s=get_ssh_limit_info");B(e)&&(y.data=e)}finally{p.value=[],d(!1)}};return C(),t({init:C}),(e,t)=>{const a=J,n=Y,l=te,i=o,d=_,r=s;return f(),h("div",null,[v(d,null,{toolsLeft:b((()=>[v(l,{class:"flex-nowrap!"},{default:b((()=>[v(a,{value:w(c),"onUpdate:value":t[0]||(t[0]=e=>I(c)?c.value=e:null),type:"text",placeholder:e.$t("Security.Anti.Index_15"),class:"w-280px!"},null,8,["value","placeholder"]),v(n,{type:"primary",onClick:$},{default:b((()=>[A(S(e.$t("Public.Btn.Add")),1)])),_:1})])),_:1})])),table:b((()=>[v(i,{"checked-row-keys":w(p),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>I(p)?p.value=e:null),"row-key":"address",loading:w(u),"max-height":440,data:w(y).data,columns:w(x)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),v(r,{class:"mt-16px"},{default:b((()=>[k("li",null,S(e.$t("Security.Anti.Index_16")),1),k("li",null,S(e.$t("Security.Anti.Index_17")),1)])),_:1})])}}}),He=y({__name:"index",setup(e,{expose:t}){const{t:n}=m(),{keys:i,table:s,columns:u}=a([{key:"addtime",title:n("Site.Cert.index_68"),width:"20%"},{key:"log",title:n("Security.Anti.Index_21")}]),d=x({p:1,limit:10,search:"System hardening"}),{loading:c,setLoading:r}=l(),p=async()=>{try{r(!0);const{message:t}=await(e=$(d),T.post("/data?action=getData",{...e,table:"logs",order:"id desc"}));M(t)&&(s.data=t.data,s.total=E(t.page))}finally{i.value=[],r(!1)}var e};return p(),t({init:p}),(e,t)=>{const a=o,n=ie,l=_;return f(),j(l,{feedback:!0},{table:b((()=>[v(a,{"checked-row-keys":w(i),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>I(i)?i.value=e:null),"row-key":"addtime",loading:w(c),data:w(s).data,columns:w(u)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:b((()=>[v(n,{page:w(d).p,"onUpdate:page":t[1]||(t[1]=e=>w(d).p=e),"page-size":w(d).limit,"onUpdate:pageSize":t[2]||(t[2]=e=>w(d).limit=e),"item-count":w(s).total,"store-key":"security-log",onRefresh:p},null,8,["page","page-size","item-count"])])),_:1})}}}),je=y({__name:"index",setup(e){const{t:t}=m(),a=g("protection"),n=[{key:"protection",label:t("Security.Tabs.Index_8"),component:Ce},{key:"block",label:t("Security.Tabs.Index_9"),component:Ue},{key:"operation",label:t("Security.Tabs.Index_10"),component:He}];return(e,t)=>{const l=r;return f(),j(l,{value:w(a),"onUpdate:value":t[0]||(t[0]=e=>I(a)?a.value=e:null),options:n},null,8,["value"])}}}),Re={class:"pt-40px pb-40px"},qe={class:"mb-16px"},Le={class:"ul-style"},Oe={class:"text-center my-24px"},Pe={class:"flex justify-center"},Te={class:"item"},ze=["onClick"],Me=K(y({__name:"conversion",setup(e){const t=g(0),a=["Protection","Block IP","Operation logs"],n=()=>{d({source:102})};return(e,l)=>{const i=F,s=Y,o=ne,u=ae;return f(),j(u,null,{default:b((()=>[k("div",Re,[l[2]||(l[2]=k("div",{class:"mb-24px text-center text-22px font-bold"}," System Hardening prevention features ",-1)),k("div",qe,[k("ul",Le,[k("li",null,[v(i,{name:"security-system",size:"18"}),l[0]||(l[0]=k("span",{class:"ml-8px"},"Prevents the system from being implanted with a Trojan",-1))]),k("li",null,[v(i,{name:"security-surety",size:"30"}),l[1]||(l[1]=k("span",null,"Harden the system security configuration",-1))])])]),k("div",Oe,[v(s,{type:"primary",class:"h-36px text-14px",onClick:n},{default:b((()=>[A(S(e.$t("WP.Transition.index_7")),1)])),_:1})]),k("div",Pe,[k("div",Te,[k("ul",null,[(f(),h(H,null,q(a,((e,a)=>k("li",{class:L({active:w(t)==a}),key:a,onClick:e=>t.value=a},S(e),11,ze))),64))])]),R(v(o,{width:"100%",src:w("/static/vite/images/protection.png")},null,8,["src"]),[[O,0==w(t)]]),R(v(o,{width:"100%",src:w("/static/vite/images/block.png")},null,8,["src"]),[[O,1==w(t)]]),R(v(o,{width:"100%",src:w("/static/vite/images/log.png")},null,8,["src"]),[[O,2==w(t)]])])])])),_:1})}}}),[["__scopeId","data-v-f55518e2"]]),De={key:0};e("default",y({__name:"index",setup(e){const t=N(),{isPro:a}=C(t),n=W(),{systemHardening:l}=C(n),i=g(l.value),s=P((()=>l.value));U(s,(e=>{i.value=e}));const o=async()=>{await T.post("/plugin?name=syssafe&action=a&s=set_open",{},{requestOptions:{loading:se("Security.Api.Index_5"),successMessage:!0}}),await n.setRefresh(!0)};return(async()=>{a.value&&await c("syssafe")})(),(e,t)=>{const n=le,l=te,s=ae;return w(a)?(f(),h("div",De,[v(s,{class:"my-15px"},{default:b((()=>[v(l,{class:"p-15px items-center"},{default:b((()=>[k("span",null,S(e.$t("Security.Anti.Index_14")),1),v(n,{value:w(i),"onUpdate:value":[t[0]||(t[0]=e=>I(i)?i.value=e:null),o],"rubber-band":!1,size:"small"},null,8,["value"])])),_:1})])),_:1}),v(s,{class:"p-15px"},{default:b((()=>[v(je)])),_:1})])):(f(),j(Me,{key:1}))}}}))}}}));
