import{b as e,h as t,c as a,e as s,_ as n,f as l,K as i,a as o,r as u}from"./public.js?v=1752142539265";import{_ as d}from"./index102.js?v=1752142539265";import{_ as c}from"./index.js?v=1752142539265";import{_ as r}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1752142539265";import{k as p,P as _,r as y,e as m,U as g,X as x,Q as h,W as f,a2 as v,V as w,a3 as k,ah as S,j as b,N as I,$ as A,w as $,F as C,a1 as U,l as H,O as j,H as R,v as q,c as L}from"./vue.js?v=1752142539265";import{v as O,i as P,d as T,p as M,e as z,w as D,cz as K,m as B,x as W,_ as X,u as F}from"./page_layout.js?v=1752142539265";import{_ as N}from"./index.vue_vue_type_script_setup_true_lang.js?v=1752142539265";import{_ as Q}from"./index.vue_vue_type_script_setup_true_lang9.js?v=1752142539265";import{cz as V,cD as Z,aq as E,ay as G,bZ as J,bX as Y,cA as ee,bA as te,c1 as ae}from"./naive.js?v=1752142539265";import{_ as se}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1752142539265";import"./common.js?v=1752142539265";import"./__commonjsHelpers__.js?v=1752142539265";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1752142539265";import"./index96.js?v=1752142539265";const{t:ne}=P.global,le={class:"p-20px"},ie=p({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=_(),s=[{label:a("Security.Anti.Index_28"),value:"i"},{label:a("Security.Anti.Index_29"),value:"a"}],n=e,{getList:l}=n.data,{row:i}=n.data,o=y(null),u=m({path:"",chattr:"i",d_mode:""}),d={path:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]},d_mode:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{var t,a;await(null==(t=o.value)?void 0:t.validate()),await(a={...u,s_key:i.key},O.post("/plugin?name=syssafe&action=a&s=add_safe_path",a,{requestOptions:{loading:ne("Security.Api.Index_4"),successMessage:!0}})),null==l||l(),e()}}),(e,t)=>{const a=Q,n=V,l=Z,i=E,c=N;return x(),g("div",le,[h(c,{ref_key:"formRef",ref:o,model:f(u),rules:d},{default:v((()=>[h(n,{label:e.$t("Site.DelSite.index_2"),path:"path"},{default:v((()=>[h(a,{class:"w-280px",value:f(u).path,"onUpdate:value":t[0]||(t[0]=e=>f(u).path=e),placeholder:e.$t("Security.Anti.Index_26")},null,8,["value","placeholder"])])),_:1},8,["label"]),h(n,{label:e.$t("Security.Hardening.Index_8")},{default:v((()=>[h(l,{class:"w-280px",value:f(u).chattr,"onUpdate:value":t[1]||(t[1]=e=>f(u).chattr=e),options:s},null,8,["value"])])),_:1},8,["label"]),h(n,{label:e.$t("Security.Hardening.Index_9"),path:"d_mode"},{default:v((()=>[h(i,{class:"w-280px!",value:f(u).d_mode,"onUpdate:value":t[2]||(t[2]=e=>f(u).d_mode=e),type:"text",placeholder:e.$t("Security.Anti.Index_27")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),oe={class:"p-20px"},ue=p({__name:"index",props:{data:{}},setup(i){const{t:o}=_(),u=i,{data:d}=u,{keys:p,table:y,columns:m}=e([{key:"path",title:o("Site.DelSite.index_2")},{key:"chattr",title:o("Security.Hardening.Index_8"),render:e=>"i"==e.chattr?o("Security.Anti.Index_28"):o("Security.Anti.Index_29")},{key:"s_mode",title:o("Security.Hardening.Index_9"),render:e=>e.s_mode!==e.d_mode?"".concat(e.s_mode," >> ").concat(e.d_mode):e.d_mode},{key:"state",title:o("Config.Safe.index_156"),render:e=>h("span",{style:{color:e.state?"#20a53a":"#ff0029"}},[e.state?o("Security.Anti.Index_35"):o("Security.Anti.Index_36")])},t({width:130,title:o("Public.Table.Operation"),options:e=>[{label:o("Public.Btn.Del"),onClick:async()=>{await(e=>O.post("/plugin?name=syssafe&action=a&s=remove_safe_path",e,{requestOptions:{loading:ne("Security.Api.Index_3"),successMessage:!0}}))({s_key:d.key,path:e.path}),await C()}}]})]),I=async()=>{U.data.row=d,U.show=!0},{loading:A,setLoading:$}=a(),C=async()=>{try{$(!0);const{message:e}=await(e=>O.post("/plugin?name=syssafe&action=a&s=get_safe_config",e))({s_key:d.key});T(e)&&(y.data=e.paths)}finally{p.value=[],$(!1)}};C();const U=s(o("Security.Anti.Index_30"),{getList:C});return(e,t)=>{const a=G,s=l,i=n,o=r,u=c;return x(),g("div",oe,[h(o,null,{toolsLeft:v((()=>[h(a,{type:"primary",onClick:I},{default:v((()=>[b(k(e.$t("Security.Anti.Index_30")),1)])),_:1})])),table:v((()=>[h(s,{"checked-row-keys":f(p),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>S(p)?p.value=e:null),loading:f(A),"loading-num":3,"max-height":340,data:f(y).data,columns:f(m)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:v((()=>[h(i,null,{default:v((()=>[w("li",null,k(e.$t("Security.Anti.Index_31")),1),w("li",null,k(e.$t("Security.Anti.Index_32")),1),w("li",null,k(e.$t("Security.Anti.Index_33")),1),w("li",null,k(e.$t("Security.Anti.Index_34")),1)])),_:1})])),_:1}),h(u,{show:f(U).show,"onUpdate:show":t[1]||(t[1]=e=>f(U).show=e),title:f(U).title,data:f(U).data,width:500,footer:!0,component:ie},null,8,["show","title","data"])])}}}),de={class:"p-20px"},ce={class:"leading-32px"},re=z(p({__name:"index",setup(e){const{t:t}=_(),a=y(null),s=m({cycle:120,limit_count:3,limit:3600}),l={cycle:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]},limit_count:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]},limit:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]}},i=async()=>{var e,t;await(null==(e=a.value)?void 0:e.validate()),await(t=I(s),O.post("/plugin?name=syssafe&action=a&s=save_ssh_config",t,{requestOptions:{loading:ne("Security.Api.Index_6"),successMessage:!0}}))};return(async()=>{const{message:e}=await O.post("/plugin?name=syssafe&action=a&s=get_ssh_config");T(e)&&(s.cycle=e.cycle,s.limit=e.limit,s.limit_count=e.limit_count)})(),(e,t)=>{const o=J,u=V,d=G,c=N,r=M,p=n;return x(),g("div",de,[h(c,{ref_key:"formRef",ref:a,model:f(s),rules:l,inline:"","label-width":"auto",class:"form"},{default:v((()=>[h(u,{label:e.$t("Security.Anti.Index_37"),path:"cycle"},{default:v((()=>[h(o,{"show-button":!1,value:f(s).cycle,"onUpdate:value":t[0]||(t[0]=e=>f(s).cycle=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),h(u,{label:e.$t("Security.Anti.Index_38"),path:"limit_count"},{default:v((()=>[h(o,{"show-button":!1,value:f(s).limit_count,"onUpdate:value":t[1]||(t[1]=e=>f(s).limit_count=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),h(u,{label:e.$t("Security.Anti.Index_39"),path:"limit"},{default:v((()=>[h(o,{"show-button":!1,value:f(s).limit,"onUpdate:value":t[2]||(t[2]=e=>f(s).limit=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),w("span",ce,k(e.$t("Security.Anti.Index_40")),1),h(d,{type:"primary",class:"ml-auto",onClick:i},{default:v((()=>[b(k(e.$t("Site.Cert.index_60")),1)])),_:1})])),_:1},8,["model"]),h(r,{class:"mb-15px!"}),h(p,null,{default:v((()=>[w("li",null,k(e.$t("Security.Anti.Index_41")),1),w("li",null,k(e.$t("Security.Anti.Index_42")),1),w("li",null,k(e.$t("Security.Anti.Index_43")),1)])),_:1})])}}}),[["__scopeId","data-v-201446e2"]]),pe={class:"p-20px"},_e=p({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=_(),s=e,{getList:n}=s.data,l=y(null),i=m({process_name:""}),o={process_name:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{var t,a;await(null==(t=l.value)?void 0:t.validate()),await(a=I(i),O.post("/plugin?name=syssafe&action=a&s=add_process_white",a,{requestOptions:{loading:ne("Security.Api.Index_4"),successMessage:!0}})),null==n||n(),e()}}),(e,t)=>{const a=E,s=V,n=N;return x(),g("div",pe,[h(n,{ref_key:"formRef",ref:l,model:f(i),rules:o},{default:v((()=>[h(s,{label:e.$t("Home.index_24"),path:"process_name"},{default:v((()=>[h(a,{class:"w-280px!",value:f(i).process_name,"onUpdate:value":t[0]||(t[0]=e=>f(i).process_name=e),type:"text",placeholder:e.$t("Security.Anti.Index_22")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),ye={class:"p-20px"},me=p({__name:"index",setup(i){const{t:o}=_(),{keys:u,table:d,columns:p}=e([{key:"name",title:o("Home.index_24")},t({width:130,title:o("Public.Table.Operation"),options:e=>[{label:o("Public.Btn.Del"),onClick:async()=>{var t;await(t={process_name:e.name},O.post("/plugin?name=syssafe&action=a&s=remove_process_white",t,{requestOptions:{loading:ne("Security.Api.Index_3"),successMessage:!0}})),await A()}}]})]),y=async()=>{$.show=!0},{loading:m,setLoading:I}=a(),A=async()=>{try{I(!0);const{message:e}=await O.post("/plugin?name=syssafe&action=a&s=get_process_white");D(e)&&(d.data=e.map((e=>({name:e}))))}finally{u.value=[],I(!1)}};A();const $=s(o("Security.Anti.Index_23"),{getList:A});return(e,t)=>{const a=G,s=l,i=n,o=r,_=c;return x(),g("div",ye,[h(o,null,{toolsLeft:v((()=>[h(a,{type:"primary",onClick:y},{default:v((()=>[b(k(e.$t("Security.Anti.Index_23")),1)])),_:1})])),table:v((()=>[h(s,{"checked-row-keys":f(u),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>S(u)?u.value=e:null),loading:f(m),"loading-num":3,"max-height":340,data:f(d).data,columns:f(p)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:v((()=>[h(i,null,{default:v((()=>[w("li",null,k(e.$t("Security.Anti.Index_24")),1),w("li",null,k(e.$t("Security.Anti.Index_25")),1)])),_:1})])),_:1}),h(_,{show:f($).show,"onUpdate:show":t[1]||(t[1]=e=>f($).show=e),title:f($).title,data:f($).data,width:500,footer:!0,component:_e},null,8,["show","title","data"])])}}}),ge={class:"color-#ff3333"},xe=p({__name:"index",setup(o,{expose:u}){const{t:d}=_(),p=K(),{systemHardening:y}=A(p),m=s(),b=s(),I=s(),{keys:U,table:H,columns:j}=e([{key:"name",width:"10%",title:d("Site.TableRow.index_2")},{key:"ps",title:d("Security.Hardening.Index_5"),ellipsis:{tooltip:{width:"trigger"}}},i({key:"open",title:d("Site.TableRow.index_14"),onClick:async(e,t)=>{if(!y.value)return B.error(d("Security.Hardening.Index_6")),void L();var a;await(a={s_key:t.key},O.post("/plugin?name=syssafe&action=a&s=set_safe_status",a,{requestOptions:{loading:ne("Security.Api.Index_5"),successMessage:!0}}))}}),t({width:130,title:d("Site.TableRow.index_30"),options:e=>[{label:d("Site.TableOP.index_3"),onClick:()=>"ssh"===e.key?(b.title="".concat(d("Security.Hardening.Index_7")," [").concat(e.name,"]"),void(b.show=!0)):"process"===e.key?(I.title="".concat(d("Security.Hardening.Index_7")," [").concat(e.name,"]"),void(I.show=!0)):(m.title="".concat(d("Security.Hardening.Index_7")," [").concat(e.name,"]"),m.data=e,void(m.show=!0))}]})]);$((()=>p.isRefresh),(e=>{e&&(p.setRefresh(!1),L())}));const{loading:R,setLoading:q}=a(),L=async()=>{try{q(!0);const{message:e}=await O.post("/plugin?name=syssafe&action=a&s=get_safe_status");T(e)&&(y.value=e.open,H.data=e.list)}finally{U.value=[],q(!1)}};return L(),u({init:L}),(e,t)=>{const a=l,s=r,i=n,o=c;return x(),g(C,null,[h(s,{feedback:!0},{table:v((()=>[h(a,{"checked-row-keys":f(U),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>S(U)?U.value=e:null),"row-key":"title",loading:f(R),data:f(H).data,columns:f(j)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),h(i,{class:"mt-16px"},{default:v((()=>[w("li",null,k(e.$t("Security.Hardening.Index_1")),1),w("li",null,k(e.$t("Security.Hardening.Index_2")),1),w("li",null,k(e.$t("Security.Hardening.Index_3")),1),w("li",ge,k(e.$t("Security.Hardening.Index_4")),1)])),_:1}),h(o,{show:f(m).show,"onUpdate:show":t[1]||(t[1]=e=>f(m).show=e),title:f(m).title,data:f(m).data,width:700,"min-height":500,footer:!1,component:ue},null,8,["show","title","data"]),h(o,{show:f(b).show,"onUpdate:show":t[2]||(t[2]=e=>f(b).show=e),title:f(b).title,data:f(b).data,width:800,footer:!1,component:re},null,8,["show","title","data"]),h(o,{show:f(I).show,"onUpdate:show":t[3]||(t[3]=e=>f(I).show=e),title:f(I).title,data:f(I).data,width:700,"min-height":580,footer:!1,component:me},null,8,["show","title","data"])],64)}}}),he=p({__name:"index",setup(s,{expose:i}){const{t:o}=_(),{loading:u,setLoading:d}=a(),c=y(""),p=/^(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])$/,{keys:m,table:I,columns:A}=e([{key:"address",title:o("Security.Anti.Index_15"),width:"70%"},{key:"end",title:o("Security.History.Index_12"),render:e=>0==e.end?o("Security.Anti.Index_18"):e.end},t({width:130,title:o("Site.TableRow.index_30"),options:e=>[{label:o("Security.Anti.Index_19"),onClick:async()=>{var t;await(t={ip:e.address},O.post("/plugin?name=syssafe&action=a&s=remove_ssh_limit",t,{requestOptions:{loading:ne("Security.Api.Index_3"),successMessage:!0}})),C()}}]})]),$=async()=>{var e;p.test(c.value)?(await(e={ip:c.value},O.post("/plugin?name=syssafe&action=a&s=add_ssh_limit",e,{requestOptions:{loading:ne("Security.Api.Index_4"),successMessage:!0}})),C(),c.value=""):B.error(o("Security.Anti.Index_20"))},C=async()=>{try{d(!0);const{message:e}=await O.post("/plugin?name=syssafe&action=a&s=get_ssh_limit_info");D(e)&&(I.data=e)}finally{m.value=[],d(!1)}};return C(),i({init:C}),(e,t)=>{const a=E,s=G,i=Y,o=l,d=r,p=n;return x(),g("div",null,[h(d,null,{toolsLeft:v((()=>[h(i,{class:"flex-nowrap!"},{default:v((()=>[h(a,{value:f(c),"onUpdate:value":t[0]||(t[0]=e=>S(c)?c.value=e:null),type:"text",placeholder:e.$t("Security.Anti.Index_15"),class:"w-280px!"},null,8,["value","placeholder"]),h(s,{type:"primary",onClick:$},{default:v((()=>[b(k(e.$t("Public.Btn.Add")),1)])),_:1})])),_:1})])),table:v((()=>[h(o,{"checked-row-keys":f(m),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>S(m)?m.value=e:null),"row-key":"address",loading:f(u),"max-height":440,data:f(I).data,columns:f(A)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),h(p,{class:"mt-16px"},{default:v((()=>[w("li",null,k(e.$t("Security.Anti.Index_16")),1),w("li",null,k(e.$t("Security.Anti.Index_17")),1)])),_:1})])}}}),fe=p({__name:"index",setup(t,{expose:s}){const{t:n}=_(),{keys:i,table:o,columns:u}=e([{key:"addtime",title:n("Site.Cert.index_68"),width:"20%"},{key:"log",title:n("Security.Anti.Index_21")}]),d=m({p:1,limit:10,search:"System hardening"}),{loading:c,setLoading:p}=a(),y=async()=>{try{p(!0);const{message:t}=await(e=I(d),O.post("/data?action=getData",{...e,table:"logs",order:"id desc"}));T(t)&&(o.data=t.data,o.total=W(t.page))}finally{i.value=[],p(!1)}var e};return y(),s({init:y}),(e,t)=>{const a=l,s=se,n=r;return x(),U(n,{feedback:!0},{table:v((()=>[h(a,{"checked-row-keys":f(i),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>S(i)?i.value=e:null),"row-key":"addtime",loading:f(c),data:f(o).data,columns:f(u)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:v((()=>[h(s,{page:f(d).p,"onUpdate:page":t[1]||(t[1]=e=>f(d).p=e),"page-size":f(d).limit,"onUpdate:pageSize":t[2]||(t[2]=e=>f(d).limit=e),"item-count":f(o).total,"store-key":"security-log",onRefresh:y},null,8,["page","page-size","item-count"])])),_:1})}}}),ve=p({__name:"index",setup(e){const{t:t}=_(),a=y("protection"),s=[{key:"protection",label:t("Security.Tabs.Index_8"),component:xe},{key:"block",label:t("Security.Tabs.Index_9"),component:he},{key:"operation",label:t("Security.Tabs.Index_10"),component:fe}];return(e,t)=>{const n=d;return x(),U(n,{value:f(a),"onUpdate:value":t[0]||(t[0]=e=>S(a)?a.value=e:null),options:s},null,8,["value"])}}}),we={class:"pt-40px pb-40px"},ke={class:"mb-16px"},Se={class:"ul-style"},be={class:"text-center my-24px"},Ie={class:"flex justify-center"},Ae={class:"item"},$e=["onClick"],Ce=z(p({__name:"conversion",setup(e){const t=y(0),a=["Protection","Block IP","Operation logs"],s=()=>{o({source:102})};return(e,n)=>{const l=X,i=G,o=te,u=ee;return x(),U(u,null,{default:v((()=>[w("div",we,[n[2]||(n[2]=w("div",{class:"mb-24px text-center text-22px font-bold"}," System Hardening prevention features ",-1)),w("div",ke,[w("ul",Se,[w("li",null,[h(l,{name:"security-system",size:"18"}),n[0]||(n[0]=w("span",{class:"ml-8px"},"Prevents the system from being implanted with a Trojan",-1))]),w("li",null,[h(l,{name:"security-surety",size:"30"}),n[1]||(n[1]=w("span",null,"Harden the system security configuration",-1))])])]),w("div",be,[h(i,{type:"primary",class:"h-36px text-14px",onClick:s},{default:v((()=>[b(k(e.$t("WP.Transition.index_7")),1)])),_:1})]),w("div",Ie,[w("div",Ae,[w("ul",null,[(x(),g(C,null,j(a,((e,a)=>w("li",{class:R({active:f(t)==a}),key:a,onClick:e=>t.value=a},k(e),11,$e))),64))])]),H(h(o,{width:"100%",src:f("/static/vite/images/protection.png")},null,8,["src"]),[[q,0==f(t)]]),H(h(o,{width:"100%",src:f("/static/vite/images/block.png")},null,8,["src"]),[[q,1==f(t)]]),H(h(o,{width:"100%",src:f("/static/vite/images/log.png")},null,8,["src"]),[[q,2==f(t)]])])])])),_:1})}}}),[["__scopeId","data-v-f55518e2"]]),Ue={key:0},He=p({__name:"index",setup(e){const t=F(),{isPro:a}=A(t),s=K(),{systemHardening:n}=A(s),l=y(n.value),i=L((()=>n.value));$(i,(e=>{l.value=e}));const o=async()=>{await O.post("/plugin?name=syssafe&action=a&s=set_open",{},{requestOptions:{loading:ne("Security.Api.Index_5"),successMessage:!0}}),await s.setRefresh(!0)};return(async()=>{a.value&&await u("syssafe")})(),(e,t)=>{const s=ae,n=Y,i=ee;return f(a)?(x(),g("div",Ue,[h(i,{class:"my-15px"},{default:v((()=>[h(n,{class:"p-15px items-center"},{default:v((()=>[w("span",null,k(e.$t("Security.Anti.Index_14")),1),h(s,{value:f(l),"onUpdate:value":[t[0]||(t[0]=e=>S(l)?l.value=e:null),o],"rubber-band":!1,size:"small"},null,8,["value"])])),_:1})])),_:1}),h(i,{class:"p-15px"},{default:v((()=>[h(ve)])),_:1})])):(x(),U(Ce,{key:1}))}}});export{He as default};


