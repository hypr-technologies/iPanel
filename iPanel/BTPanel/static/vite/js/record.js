import{_ as e}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1752142539265";import{_ as a}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1752142539265";import{b as t,h as l,f as i}from"./public.js?v=1752142539265";import{w as s,T as d,X as u,aY as o,e as n,d5 as r,d as p,x as y}from"./page_layout.js?v=1752142539265";import{f as _}from"./site3.js?v=1752142539265";import{b as m,s as c}from"./tools2.js?v=1752142539265";import{k as v,P as f,r as x,ac as b,y as g,U as h,X as M,Q as S,W as k,ah as j,a2 as w,F as W,O as z,j as L,a3 as U,e as P,ax as D,V as N}from"./vue.js?v=1752142539265";import{cB as C,cG as R}from"./naive.js?v=1752142539265";import{m as T}from"./common.js?v=1752142539265";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1752142539265";import"./rules.js?v=1752142539265";import"./__commonjsHelpers__.js?v=1752142539265";const X={class:"flex"},Y=n(v({__name:"date",props:{value:{default:"today"},valueModifiers:{}},emits:["update:value"],setup(e){const{t:a}=f(),t=x("today"),l=x(null),i=b(e,"value"),n=[{label:a("Public.Search.Today"),value:"today"},{label:a("Public.Search.Yesterday"),value:"yesterday"},{label:a("Public.Search.Last7"),value:"l7"},{label:a("Public.Search.Last30"),value:"l30"}],r=e=>{l.value=null,i.value=e},p=e=>{t.value=e?"":"today",i.value=o(e)?u(e,"yyyy-MM-dd"):"today"};return g((()=>{s(i.value)?(t.value="",l.value=i.value):(t.value=i.value,l.value=null)})),(e,a)=>{const i=R,s=C,u=d;return M(),h("div",X,[S(s,{value:k(t),"onUpdate:value":[a[0]||(a[0]=e=>j(t)?t.value=e:null),r],size:"small",class:"bt-radio"},{default:w((()=>[(M(),h(W,null,z(n,(e=>S(i,{key:e.value,value:e.value},{default:w((()=>[L(U(e.label),1)])),_:2},1032,["value"]))),64))])),_:1},8,["value"]),S(u,{value:k(l),"onUpdate:value":[a[1]||(a[1]=e=>j(l)?l.value=e:null),p],type:"daterange",size:"small",class:"bt-date-picker w-214px",clearable:!0},null,8,["value"])])}}}),[["__scopeId","data-v-9d115305"]]),B={class:"p-20px"},F=v({__name:"record",props:{siteName:{default:""},timeList:{default:()=>[]}},setup(d){const o=d,{t:n}=f(),{table:v,columns:x,setLoading:b}=t([{key:"time_localtime",title:n("Waf.Site.index_26"),width:140,render:e=>u(e.time_localtime)},{key:"ip",title:n("Waf.Site.index_27"),width:120,ellipsis:{tooltip:!0}},{key:"type",title:n("Waf.Site.index_15"),width:70,ellipsis:{tooltip:!0}},{key:"uri",title:n("Waf.Site.index_28"),ellipsis:{tooltip:{contentStyle:{maxWidth:"500px"}}},render:e=>r(e.uri)},{key:"status",title:n("Waf.Site.index_12"),width:90,render:()=>n("Waf.Site.index_29")},{key:"ip_country",title:n("Waf.Site.index_30"),width:140,ellipsis:{tooltip:!0},render:e=>e.ip_country===n("Waf.Site.index_31")?e.ip_country:(e=>e.ip_country)(e)},{key:"filter_rule",title:n("Waf.Site.index_32"),width:120,ellipsis:{tooltip:!0}},l({width:140,options:e=>[{label:n("Waf.Site.index_33"),onClick:()=>{m(e,!1)}},{label:n("Waf.Site.index_34"),onClick:()=>{c(e)}}]})]),g=P({p:1,limit:15,date:"today",ip:"",serach_url:"",user_agent:""});let j=!0;const W=()=>{if(j)return j=!1,{start_time:o.timeList[0]};const{date:e}=g,a=new Date;let t="",l="";switch(e){case"today":t=u(a,"yyyy-MM-dd");break;case"yesterday":t=u(T(a,-1),"yyyy-MM-dd");break;case"l7":t=u(T(a,-7),"yyyy-MM-dd"),l=u(a,"yyyy-MM-dd");break;case"l30":t=u(T(a,-30),"yyyy-MM-dd"),l=u(a,"yyyy-MM-dd")}return s(e)&&(t=u(new Date(e[0]),"yyyy-MM-dd"),l=u(new Date(e[1]),"yyyy-MM-dd")),{start_time:t,...l?{end_time:l}:{}}},z=async()=>{try{b(!0);const{message:e}=await _({siteName:o.siteName,p:g.p,limit:g.limit,...W()});p(e)&&(v.data=s(e.data)?e.data:[],v.total=y(e.page))}finally{b(!1)}},L=()=>{g.p=1,z()};return z(),(t,l)=>{const s=i,d=a,u=e;return M(),h("div",B,[S(u,null,D({toolsLeft:w((()=>[N("span",null,U(t.$t("Waf.Site.index_17")),1),S(Y,{value:k(g).date,"onUpdate:value":[l[0]||(l[0]=e=>k(g).date=e),L]},null,8,["value"])])),table:w((()=>[S(s,{loading:k(v).loading,"max-height":420,data:k(v).data,columns:k(x)},null,8,["loading","data","columns"])])),pageRight:w((()=>[S(d,{page:k(g).p,"onUpdate:page":l[4]||(l[4]=e=>k(g).p=e),"page-size":k(g).limit,"onUpdate:pageSize":l[5]||(l[5]=e=>k(g).limit=e),"item-count":k(v).total,"page-sizes":[10,15],onRefresh:z},null,8,["page","page-size","item-count"])])),_:2},[void 0]),1024)])}}});export{F as default};
