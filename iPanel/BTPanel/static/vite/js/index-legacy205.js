System.register(["./public-legacy.js?v=1752142539265","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1752142539265","./site-legacy.js?v=1752142539265","./page_layout-legacy.js?v=1752142539265","./naive-legacy.js?v=1752142539265","./vue-legacy.js?v=1752142539265","./common-legacy.js?v=1752142539265","./__commonjsHelpers__-legacy.js?v=1752142539265"],(function(e,a){"use strict";var l,t,n,i,s,d,u,o,r,p,c,_,m,h,y,v,f,g,S,x,w,b,L,k,A,z,$,Z,j,U,O,R,E,F,q,C,B,H,J,M,N,P,W;return{setters:[e=>{l=e.c,t=e._,n=e.ae,i=e.af,s=e.u,d=e.ag,u=e.ah,o=e.ai,r=e.ay},e=>{p=e._},e=>{c=e.a0},e=>{_=e.aF,m=e.O,h=e.d,y=e.w},e=>{v=e.cz,f=e.cB,g=e.cC,S=e._,x=e.cD,w=e.aq,b=e.cO,L=e.bX,k=e.bR},e=>{A=e.k,z=e.P,$=e.r,Z=e.e,j=e.c,U=e.w,O=e.o,R=e.U,E=e.X,F=e.Q,q=e.a2,C=e.an,B=e.W,H=e.j,J=e.a3,M=e.a1,N=e.F,P=e.O,W=e.V},null,null],execute:function(){const a={class:"p-16px"},X={key:0},D={key:1};e("default",A({__name:"index",props:{onRefresh:{type:Function},onOpenLog:{type:Function}},setup(e,{expose:A}){const{t:Q}=z(),V=e,G=$(null),I=Z({auth_type:"dns",dns_manual:0,site:0,type:"wildcard",domains:"",domains_list:[],all:!1}),K=$([{label:Q("SSL.index_17"),value:"single"},{label:Q("SSL.index_18"),value:"wildcard"},{label:Q("SSL.index_19"),value:"wildcard_all"}]),T=$([]),Y=$([]),ee=()=>{I.domains=""},ae=()=>{I.domains_list=[],de()},le=j((()=>I.domains_list.length>0&&I.domains_list.length<Y.value.length));U((()=>I.domains_list),(e=>{e.length===Y.value.length?I.all=!0:e.length||(I.all=!1)})),U((()=>I.all),(e=>{e?(I.domains_list=Y.value.map((e=>e.name)),G.value?.validate()):I.domains_list=[]}));const te={domains:{required:!0,trigger:"input",validator:(e,a)=>{if("single"===I.type){if(!a)return new Error(Q("SSL.index_20"));if(!/^[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+$/.test(a))return new Error(Q("SSL.index_21"))}else if("wildcard"===I.type){if(!a)return new Error(Q("SSL.index_22"));if(!/^(?:\*\.)?(?:[a-zA-Z0-9-]+\.)?[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+(\n(?:\*\.)?(?:[a-zA-Z0-9-]+\.)?[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+)*$/.test(a))return new Error(Q("SSL.index_23"))}else if("wildcard_all"===I.type){if(!a)return new Error(Q("SSL.index_24"));if(!/^\*\.[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+(\n\*\.[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+)*$/i.test(a))return new Error(Q("SSL.index_25"))}return!0}},domains_list:{required:!0,trigger:"change",type:"array",message:Q("SSL.SiteSSL.index_16")}},ne=()=>({auth_type:I.dns_manual?"dns_manual":I.auth_type,domains:JSON.stringify("http"===I.auth_type?I.domains_list:"single"===I.type?[I.domains]:I.domains.split("\n")),site_id:I.dns_manual?-1:void 0}),{loading:ie,setLoading:se}=l(),de=async()=>{try{se(!0);const{message:e}=await c({id:I.site});y(e)&&(Y.value=e.map((e=>({name:e.name}))))}finally{se(!1)}};return O((async()=>{await(async()=>{const{message:e}=await r();y(e)&&(T.value=e.map((e=>({label:e.name,value:e.id}))),I.site=T.value[0].value)})(),de()})),A({onConfirm:async()=>{if(await(G.value?.validate()),I.dns_manual){const e=JSON.stringify("http"===I.auth_type?I.domains_list:"single"===I.type?[I.domains]:I.domains.split("\n")),{message:l}=await n({site_id:-1,domains:e});if(h(l)&&Object.keys(l).length)return i(l.auths,-1,[I.domains],(()=>{V.onRefresh()}),!0),!1;const t=s({width:500,height:300,hideClose:!0,component:d});try{const{message:e}=await u(ne(),!1);if(h(e)){if(e.deploy)return void V.onRefresh();Array.isArray(e.auths)&&e.auths.length&&i(e.auths,-1,[I.domains],(()=>{V.onRefresh()}))}}catch(a){o(k(a,"message",""))}finally{t.hide()}return}const{message:e}=await u(ne());h(e)&&V.onOpenLog(e.path),V.onRefresh()}}),(e,l)=>{const n=g,i=_,s=f,d=v,u=S,o=x,r=w,c=L,h=b,y=m,k=p,A=t;return E(),R("div",a,[F(k,{ref_key:"formRef",ref:G,model:B(I),rules:te,"label-width":"150px"},{default:q((()=>[F(d,{label:e.$t("Waf.Setting.config_67"),path:"verify_method"},{default:q((()=>[F(s,{value:B(I).auth_type,"onUpdate:value":l[0]||(l[0]=e=>B(I).auth_type=e)},{default:q((()=>[F(i,null,{default:q((()=>[F(n,{value:"dns"},{default:q((()=>[H(J(e.$t("SSL.index_12")),1)])),_:1}),F(n,{value:"http"},{default:q((()=>[H(J(e.$t("SSL.SiteSSL.index_17")),1)])),_:1})])),_:1})])),_:1},8,["value"])])),_:1},8,["label"]),"dns"===B(I).auth_type?(E(),R("div",X,[F(d,{label:" "},{default:q((()=>[F(u,{checked:B(I).dns_manual,"onUpdate:checked":l[1]||(l[1]=e=>B(I).dns_manual=e),"checked-value":1,"unchecked-value":0},{default:q((()=>[H(J(e.$t("SSL.index_2")),1)])),_:1},8,["checked"])])),_:1}),F(d,{label:e.$t("SSL.index_13"),path:"type"},{default:q((()=>[F(o,{class:"w-300px",value:B(I).type,"onUpdate:value":[l[2]||(l[2]=e=>B(I).type=e),ee],options:B(K)},null,8,["value","options"])])),_:1},8,["label"]),"single"===B(I).type?(E(),M(d,{key:0,label:" ",path:"domains"},{default:q((()=>[F(r,{"input-props":{spellcheck:!1},class:"w-300px!",value:B(I).domains,"onUpdate:value":l[3]||(l[3]=e=>B(I).domains=e),placeholder:"iPanel.com"},null,8,["value"])])),_:1})):C("",!0),"wildcard"===B(I).type?(E(),M(d,{key:1,label:" ",path:"domains"},{default:q((()=>[F(r,{"input-props":{spellcheck:!1},type:"textarea",class:"w-300px!",value:B(I).domains,"onUpdate:value":l[4]||(l[4]=e=>B(I).domains=e),placeholder:e.$t("SSL.index_14")},null,8,["value","placeholder"])])),_:1})):C("",!0),"wildcard_all"===B(I).type?(E(),M(d,{key:2,label:" ",path:"domains"},{default:q((()=>[F(r,{"input-props":{spellcheck:!1},type:"textarea",class:"w-300px!",value:B(I).domains,"onUpdate:value":l[5]||(l[5]=e=>B(I).domains=e),placeholder:"*.iPanel.com"},null,8,["value"])])),_:1})):C("",!0)])):C("",!0),"http"===B(I).auth_type?(E(),R("div",D,[F(d,{label:e.$t("Home.index_68")},{default:q((()=>[F(o,{class:"w-300px",value:B(I).site,"onUpdate:value":[l[6]||(l[6]=e=>B(I).site=e),ae],options:B(T)},null,8,["value","options"])])),_:1},8,["label"]),F(d,{label:e.$t("Mail.Bcc.index_6"),path:"domains_list"},{default:q((()=>[F(y,{show:B(ie),class:"p-12px w-300px max-h-300px min-h-100px overflow-auto border border-solid border-#ccc"},{default:q((()=>[F(u,{class:"mb-12px",checked:B(I).all,"onUpdate:checked":l[7]||(l[7]=e=>B(I).all=e),label:e.$t("Public.SelectAll"),indeterminate:B(le)},null,8,["checked","label","indeterminate"]),F(h,{value:B(I).domains_list,"onUpdate:value":l[8]||(l[8]=e=>B(I).domains_list=e)},{default:q((()=>[F(c,{class:"flex-col!",size:12},{default:q((()=>[(E(!0),R(N,null,P(B(Y),(e=>(E(),M(u,{key:e.name,value:e.name,label:e.name},null,8,["value","label"])))),128))])),_:1})])),_:1},8,["value"])])),_:1},8,["show"])])),_:1},8,["label"])])):C("",!0)])),_:1},8,["model"]),F(A,{class:"mt-16px"},{default:q((()=>[W("li",null,J(e.$t("SSL.index_15")),1),l[9]||(l[9]=W("li",null,"Manually resolved certificates do not support auto-renewal",-1)),W("li",null,J(e.$t("SSL.index_16")),1)])),_:1,__:[9]})])}}}))}}}));


