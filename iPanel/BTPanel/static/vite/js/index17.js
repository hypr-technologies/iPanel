const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index108.js?v=1752142539265","js/index101.js?v=1752142539265","js/vue.js?v=1752142539265","js/__commonjsHelpers__.js?v=1752142539265","js/page_layout.js?v=1752142539265","js/naive.js?v=1752142539265","js/common.js?v=1752142539265","js/public.js?v=1752142539265","css/public.css?v=1752142539265","css/page_layout.css?v=1752142539265","css/index18.css?v=1752142539265","js/index.js?v=1752142539265","css/index96.css?v=1752142539265","js/index.vue_vue_type_script_setup_true_lang.js?v=1752142539265","js/backup-info.js?v=1752142539265","js/utils.js?v=1752142539265","js/soft.js?v=1752142539265","css/backup-info.css?v=1752142539265","js/migrate-success.js?v=1752142539265","js/migrate-error.js?v=1752142539265"])))=>i.map(i=>d[i]);
import{O as e,n as a,_ as t,v as s,i as o,a as l,d as r}from"./page_layout.js?v=1752142539265";import{_ as i}from"./index.js?v=1752142539265";import{e as n,q as p,_ as d}from"./public.js?v=1752142539265";import{_ as u}from"./index.vue_vue_type_script_setup_true_lang.js?v=1752142539265";import _ from"./backup-info.js?v=1752142539265";import{u as c}from"./utils.js?v=1752142539265";import{k as m,P as g,$ as h,a1 as w,X as f,W as x,a2 as b,Q as v,V as C,j as y,a3 as k,e as M,r as j,_ as T,a4 as q}from"./vue.js?v=1752142539265";import{cz as O,bX as P,cH as D,b$ as $,c3 as U,aq as R,bZ as E,ay as A,cA as I}from"./naive.js?v=1752142539265";const V=m({__name:"index",setup(s){const{t:o}=g(),l=c(),{loading:r,backupData:i}=h(l);return l.getData(),(s,l)=>{const n=D,p=t,d=$,c=P,m=O,g=u,h=e;return f(),w(h,{show:x(r),class:"p-16px"},{default:b((()=>[v(g,{ref:"formRef"},{default:b((()=>[v(m,{label:x(o)("Config.Migrate.index_10")},{default:b((()=>[v(c,null,{default:b((()=>[v(n,{class:"mr-8px"},{default:b((()=>[y(k(x(a)(x(i).disk_use)),1)])),_:1}),C("div",null,[C("span",null,k(x(o)("Config.Migrate.index_11")),1),v(n,{type:"success",class:"ml-16px mr-8px"},{default:b((()=>[y(k(x(a)(x(i).disk_free)),1)])),_:1}),v(d,{trigger:"hover",placement:"top-start"},{trigger:b((()=>[v(p,{name:"base-warning",class:"text-warning mr-4px",size:"16"})])),default:b((()=>[C("span",null,[C("li",null,k(x(o)("Config.Migrate.index_12"))+" "+k(x(a)(1.5*x(i).disk_use)),1),C("li",null,k(x(o)("Config.Migrate.index_13")),1)])])),_:1})])])),_:1})])),_:1},8,["label"]),v(m,{label:"Backup Data"},{default:b((()=>[v(_,{class:"w-600px"})])),_:1})])),_:1},512)])),_:1},8,["show"])}}}),z=()=>s.post("/mod/backup_restore/com/get_migrate_progress"),L=()=>s.post("/mod/backup_restore/com/stop_migrate",{},{requestOptions:{loading:o.global.t("Component.Pay.index_12"),successMessage:!0}}),S=()=>s.post("/mod/backup_restore/com/close_migrate_popup",{},{requestOptions:{loading:o.global.t("Component.Pay.index_12"),successMessage:!1}}),X=m({__name:"index",setup(e){const a=T((()=>l((()=>import("./index108.js?v=1752142539265")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17])))),t=T((()=>l((()=>import("./migrate-success.js?v=1752142539265")),__vite__mapDeps([18,7,4,2,3,5,6,9,8,11,12,13,14,15,16,17])))),_=T((()=>l((()=>import("./migrate-error.js?v=1752142539265")),__vite__mapDeps([19,7,4,2,3,5,6,9,8,11,12,13,14,15,16,17])))),{t:c}=g(),m=n(c("Config.Migrate.index_4")),h=n(c("Config.Migrate.index_5"),{onRefresh:(e,a)=>{"success"===e?(D.data=a,D.show=!0):($.data.errData=a,$.show=!0)}}),D=n(c("Config.Migrate.index_6")),$=n(c("Config.Migrate.index_7"),{onRetry:e=>{$.show=!1,h.show=!1,L.ip=e.server_ip,L.port=e.ssh_port,L.account=e.ssh_user,L.password=e.password,H()}}),z=j(null),L=M({ip:"",port:22,account:"",password:""}),S={ip:{required:!0,message:c("Term.index_9"),trigger:["blur","input"]},port:{required:!0,type:"number",message:c("Security.Conf.Index_28"),trigger:["blur","input"]},account:{required:!0,message:c("Term.index_11"),trigger:["blur","input"]},password:{required:!0,message:c("Term.index_14"),trigger:["blur","input"]}},X=()=>{m.show=!0},B=()=>({auth_type:"password",server_ip:L.ip,ssh_port:L.port,ssh_user:L.account,password:L.password,ps:L.ip}),H=async()=>{var e;await(null==(e=z.value)?void 0:e.validate()),p({title:c("Config.Migrate.index_8"),content:()=>v("span",null,[v(q("i18n-t"),{keypath:"Config.Migrate.index_9",scope:"global"},{default:()=>[v("b",{class:"color-warning text-2xl"},[y(" "),L.ip,y(" ")])]})]),onConfirm:async()=>{var e;await(e=B(),s.post("/mod/backup_restore/com/ssh_auth_check",e,{requestOptions:{loading:o.global.t("Component.Pay.index_12"),successMessage:!0}})),await(e=>s.post("/mod/backup_restore/com/add_migrate_task",e,{requestOptions:{loading:o.global.t("Component.Pay.index_12"),successMessage:!0}}))(B()),h.show=!0}})};return(async()=>{const{message:e}=await s.post("/mod/backup_restore/com/get_migrate_status");r(e)&&e.is_running&&(h.show=!0,L.ip=e.server_ip,L.port=e.ssh_port,L.account=e.ssh_user,L.password=e.password)})(),(e,s)=>{const o=R,l=O,r=E,n=P,p=A,g=u,M=d,j=i,T=I;return f(),w(T,{class:"p-16px"},{default:b((()=>[v(x(U),{type:"warning",class:"mb-16px"},{default:b((()=>[C("span",null,k(x(c)("Config.Migrate.index_1")),1)])),_:1}),v(g,{ref_key:"formRef",ref:z,model:x(L),rules:S},{default:b((()=>[v(n,null,{default:b((()=>[v(l,{label:e.$t("Term.index_8"),path:"ip"},{default:b((()=>[v(o,{class:"w-190px!",value:x(L).ip,"onUpdate:value":s[0]||(s[0]=e=>x(L).ip=e),placeholder:e.$t("Term.index_9")},null,8,["value","placeholder"])])),_:1},8,["label"]),v(l,{path:"port"},{default:b((()=>[v(r,{"show-button":!1,class:"w-80px!",value:x(L).port,"onUpdate:value":s[1]||(s[1]=e=>x(L).port=e),placeholder:e.$t("Docker.Container.create.index_7")},null,8,["value","placeholder"])])),_:1})])),_:1}),v(l,{label:e.$t("Term.index_10"),path:"account"},{default:b((()=>[v(o,{class:"w-280px!",value:x(L).account,"onUpdate:value":s[2]||(s[2]=e=>x(L).account=e),placeholder:e.$t("Term.index_11")},null,8,["value","placeholder"])])),_:1},8,["label"]),v(l,{label:e.$t("Database.index_14"),path:"password"},{default:b((()=>[v(o,{class:"w-280px!",value:x(L).password,"onUpdate:value":s[3]||(s[3]=e=>x(L).password=e),placeholder:e.$t("Term.index_14")},null,8,["value","placeholder"])])),_:1},8,["label"]),v(l,{label:" "},{default:b((()=>[v(p,{type:"primary",onClick:H},{default:b((()=>[y(k(x(c)("Config.Migrate.index_2")),1)])),_:1})])),_:1})])),_:1},8,["model"]),v(M,null,{default:b((()=>[s[8]||(s[8]=C("li",{class:"text-warning font-bold"},"Please use root user",-1)),C("li",null,[v(p,{type:"primary",text:"",onClick:X},{default:b((()=>[y(k(x(c)("Config.Migrate.index_3")),1)])),_:1})])])),_:1,__:[8]}),v(j,{show:x(m).show,"onUpdate:show":s[4]||(s[4]=e=>x(m).show=e),title:x(m).title,data:x(m).data,width:"850","min-height":250,component:V},null,8,["show","title","data"]),v(j,{show:x(h).show,"onUpdate:show":s[5]||(s[5]=e=>x(h).show=e),title:x(h).title,hideClose:!0,data:x(h).data,width:"750","min-height":250,component:x(a)},null,8,["show","title","data","component"]),v(j,{show:x(D).show,"onUpdate:show":s[6]||(s[6]=e=>x(D).show=e),title:x(D).title,hideClose:!0,data:x(D).data,width:"750","min-height":250,component:x(t)},null,8,["show","title","data","component"]),v(j,{show:x($).show,"onUpdate:show":s[7]||(s[7]=e=>x($).show=e),title:x($).title,hideClose:!0,data:x($).data,width:"750","min-height":250,component:x(_)},null,8,["show","title","data","component"])])),_:1})}}}),B=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"}));export{S as a,L as c,z as g,B as i};


