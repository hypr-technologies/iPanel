const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index169.js?v=1752142539265","js/index102.js?v=1752142539265","js/vue.js?v=1752142539265","js/__commonjsHelpers__.js?v=1752142539265","js/naive.js?v=1752142539265","js/common.js?v=1752142539265","js/page_layout.js?v=1752142539265","js/public.js?v=1752142539265","css/public.css?v=1752142539265","css/page_layout.css?v=1752142539265","css/index19.css?v=1752142539265","js/index.vue_vue_type_script_setup_true_lang.js?v=1752142539265","js/index.vue_vue_type_script_setup_true_lang14.js?v=1752142539265","js/theme-chrome.js?v=1752142539265","js/file.js?v=1752142539265","js/index172.js?v=1752142539265","css/index23.css?v=1752142539265","js/index.vue_vue_type_script_setup_true_lang23.js?v=1752142539265","js/index100.js?v=1752142539265","css/index17.css?v=1752142539265","js/index170.js?v=1752142539265","js/xterm-addon-canvas.js?v=1752142539265","css/xterm-addon-canvas.css?v=1752142539265","js/xterm.js?v=1752142539265","css/index73.css?v=1752142539265","js/index171.js?v=1752142539265","js/index.js?v=1752142539265","css/index96.css?v=1752142539265","js/index.vue_vue_type_script_setup_true_lang4.js?v=1752142539265","js/index.vue_vue_type_script_setup_true_lang7.js?v=1752142539265","css/index16.css?v=1752142539265"])))=>i.map(i=>d[i]);
import{i as e,a as t,v as a,e as s,m as l,d as o,O as n,_ as c,X as r,bG as i,w as u,q as d,o as p}from"./page_layout.js?v=1752142539265";import{u as m,d as _,c as v,C as f,z as k}from"./public.js?v=1752142539265";import{i as x,p as h,_ as g,k as w,r as C,aA as b,U as j,X as y,l as D,v as S,W as N,V as P,au as $,H as I,a3 as O,ag as A,ah as L,n as R,t as z,P as U,c as E,Q as J,a2 as B,j as H,a1 as V,an as q,ac as M,w as T,F as K,O as X,aj as F,I as G}from"./vue.js?v=1752142539265";import{_ as Q,cH as W,ay as Y,B as Z,aq as ee,cA as te,aT as ae,c0 as se}from"./naive.js?v=1752142539265";import{_ as le}from"./index.vue_vue_type_script_setup_true_lang13.js?v=1752142539265";import{a as oe}from"./useModal.js?v=1752142539265";import{_ as ne}from"./index172.js?v=1752142539265";import{_ as ce}from"./index.vue_vue_type_script_setup_true_lang14.js?v=1752142539265";import"./common.js?v=1752142539265";import"./__commonjsHelpers__.js?v=1752142539265";import"./theme-chrome.js?v=1752142539265";import"./file.js?v=1752142539265";const re=Symbol("docker-compose");function ie(){return x(re)}const ue=a=>{m({title:e.global.t("Docker.ComposeNew.index_38"),width:640,minHeight:300,footer:!0,data:a,component:g((()=>t((()=>import("./index169.js?v=1752142539265")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))))})},de=(a,s)=>{m({title:e.global.t("Docker.ComposeNew.index_39",[a]),width:640,height:440,data:s,component:g((()=>t((()=>import("./index170.js?v=1752142539265")),__vite__mapDeps([20,21,22,23,6,2,3,4,5,7,8,9,24]))))})},pe=s(w({__name:"menu-item-remark",props:{value:{default:""},blur:{}},setup(e){const t=e,a=C(t.value),s=C(!1),l=C(null),o=C(null),{isOutside:n}=b(l),c=()=>{a.value=t.value,s.value=!0,R((()=>{var e;null==(e=o.value)||e.focus()}))},r=async()=>{var e;try{await(null==(e=t.blur)?void 0:e.call(t,a.value))}finally{s.value=!1}};return(e,t)=>(y(),j("div",{ref_key:"remarkRef",ref:l,class:"text-desc"},[D(P("div",{class:I(["project-remark",{active:N(n)}]),onClick:$(c,["stop"])},O(e.value||e.$t("Docker.ComposeNew.index_12")),3),[[S,!N(s)]]),D(P("input",{ref_key:"inputRef",ref:o,"onUpdate:modelValue":t[0]||(t[0]=e=>L(a)?a.value=e:null),class:"project-input",onBlur:r},null,544),[[S,N(s)],[A,N(a)]])],512))}}),[["__scopeId","data-v-2d5d24e1"]]),me={class:"flex-1 pr-16px overflow-hidden"},_e={class:"menu-name"},ve=s(w({__name:"menu-item",props:{checked:{type:Boolean},active:{type:Boolean,default:!1},project:{}},emits:["changeChecked"],setup(t,{emit:s}){const l=s,o=z(t,"project"),{t:n}=U(),c=E((()=>{const e={text:n("Public.Status.Abnormal"),type:"warning"};switch(o.value.run_status){case"running":e.text=n("Public.Status.Running"),e.type="success";break;case"exited":e.text=n("Public.Status.Stopped"),e.type="error"}return e})),r=e=>{l("changeChecked",e,o.value.name)},i=async t=>{var s;t!==o.value.remark&&(await(s={name:o.value.name,remark:t,path:o.value.path},a.post("/mod/docker/com/edit_remark",s,{requestOptions:{loading:e.global.t("Docker.api.index_54"),successMessage:!0}})),o.value.remark=t)};return(e,t)=>{const a=Q,s=W;return y(),j("div",{class:I(["menu-item",{active:e.active}])},[J(a,{checked:e.checked,onClick:$((()=>!1),["stop"]),"onUpdate:checked":r},null,8,["checked"]),J(s,{class:"ml-16px mr-10px",size:"small",type:N(c).type},{default:B((()=>[H(O(N(c).text),1)])),_:1},8,["type"]),P("div",me,[P("div",_e,O(N(o).name),1),e.active||N(o).remark?(y(),V(pe,{key:0,value:N(o).remark,class:"mt-2px",blur:i},null,8,["value"])):q("",!0)])],2)}}}),[["__scopeId","data-v-7ef5af54"]]),fe={class:"flex items-center p-16px"},ke=w({__name:"menu-list-batch",props:{value:{default:()=>[]},valueModifiers:{}},emits:["update:value"],setup(e){const{t:t}=U(),{projectList:a,sendSocket:s}=ie(),n=M(e,"value"),c=E({get:()=>n.value.length>0&&n.value.length===a.value.length,set(e){n.value=e?a.value.map((e=>e.name)):[]}}),r=E((()=>0===a.value.length)),i=E((()=>n.value.length>0&&n.value.length<a.value.length)),u=E((()=>0===n.value.length)),d=()=>{_({title:t("Docker.ComposeNew.index_5"),content:t("Docker.ComposeNew.index_6",[n.value.length]),onConfirm:({hide:e})=>(p(e),!1)})},p=e=>{const{close:c}=l.loading(t("Docker.ComposeNew.index_7")),r=[],i=a.value.filter((e=>n.value.includes(e.name))).map((e=>({project_name:e.name,path:e.path})));s({def_name:"batch_delete",mod_name:"docker",project_list:i,sub_mod_name:"com",ws_callback:"batch_delete"},{action:"batch_delete",callback:(a,s)=>{const l=JSON.parse(s.data),{data:n}=l;o(n)&&r.push({project_name:n.project_name,batchStatus:n.status?"success":"error",reqMsg:n.status?t("Docker.ComposeNew.index_11"):t("Docker.ComposeNew.index_8")}),-1===n&&(c(),e(),m({title:t("Docker.ComposeNew.index_9"),width:440,footer:!0,component:le,data:{title:t("Docker.ComposeNew.index_5"),data:r,status:"done",columns:[{key:"project_name",title:t("Docker.ComposeNew.index_10"),ellipsis:{tooltip:{width:"trigger"}}}]}}))}})};return(e,t)=>{const a=Q,s=Y;return y(),j("div",fe,[J(a,{checked:N(c),"onUpdate:checked":t[0]||(t[0]=e=>L(c)?c.value=e:null),disabled:N(r),indeterminate:N(i)},null,8,["checked","disabled","indeterminate"]),J(s,{type:"primary",class:"ml-16px",disabled:N(u),onClick:d},{default:B((()=>[H(O(e.$t("Docker.ComposeNew.index_4")),1)])),_:1},8,["disabled"])])}}}),xe={class:"project-list"},he={key:1,class:"flex-center h-280px"},ge=s(w({__name:"menu-list",setup(e){const{timestamp:t,loading:a,projectActive:s,projectList:l,refreshCompose:o}=ie(),c=C([]),r=e=>{for(const t of c.value)if(t===e)return!0;return!1},i=(e,t)=>{e?c.value.push(t):c.value=c.value.filter((e=>e!==t))};return T((()=>t.value),(()=>{c.value=[]})),(e,t)=>{const u=Z,d=n;return N(l).length>0?(y(),j(K,{key:0},[P("div",xe,[(y(!0),j(K,null,X(N(l),((e,t)=>(y(),V(ve,{key:e.id,project:e,active:t===N(s),checked:r(e.name),onClick:e=>(e=>{s.value=e,o()})(t),onChangeChecked:i},null,8,["project","active","checked","onClick"])))),128))]),J(ke,{value:N(c),"onUpdate:value":t[0]||(t[0]=e=>L(c)?c.value=e:null)},null,8,["value"])],64)):(y(),j("div",he,[J(d,{show:N(a)},{default:B((()=>[J(u)])),_:1},8,["show"])]))}}}),[["__scopeId","data-v-fb57e04a"]]),we={class:"p-16px"},Ce={class:"mb-12px"},be=w({__name:"menu",setup(e){const{t:a}=U(),{projectList:s,projectListAll:l,sendSocket:o,refreshCompose:n}=ie(),r=C(""),i=()=>{ue({send:o,refresh:n})},u=()=>{m({title:a("Docker.ComposeNew.index_2"),width:1e3,minHeight:200,component:g((()=>t((()=>import("./index171.js?v=1752142539265")),__vite__mapDeps([25,6,2,3,4,5,7,8,9,26,27,28,29,30]))))})},d=e=>{s.value=l.value.filter((t=>t.name.includes(e)))};return(e,t)=>{const a=Y,s=c,l=ee,o=te;return y(),V(o,{class:"w-260px h-full mr-16px"},{default:B((()=>[P("div",we,[P("div",Ce,[J(a,{type:"primary",onClick:i},{default:B((()=>[H(O(e.$t("Docker.ComposeNew.index_1")),1)])),_:1}),J(a,{class:"ml-12px",onClick:u},{default:B((()=>[H(O(e.$t("Docker.ComposeNew.index_2")),1)])),_:1})]),J(l,{value:N(r),"onUpdate:value":[t[0]||(t[0]=e=>L(r)?r.value=e:null),d],placeholder:e.$t("Docker.ComposeNew.index_3")},{prefix:B((()=>[J(s,{name:"search",size:"16",color:"#999"})])),_:1},8,["value","placeholder"])]),J(ge)])),_:1})}}}),je={class:"flex items-center p-16px"},ye={class:"max-w-500px mr-40px"},De={class:"mb-12px text-18px truncate"},Se={class:"flex gap-10px text-desc"},Ne=s(w({__name:"main-status",setup(e){const{t:t}=U(),{currentProject:a,projectActive:s,setProjectStatus:n,refreshCompose:c}=ie(),i=()=>{_({title:t("Docker.ComposeNew.index_17",[a.value.name]),content:t("Docker.ComposeNew.index_18"),onConfirm:()=>{de(a.value.name,{status:"start",setProjectStatus:n})}})},u=()=>{_({title:t("Docker.ComposeNew.index_19",[a.value.name]),content:t("Docker.ComposeNew.index_20"),onConfirm:()=>{de(a.value.name,{status:"stop",setProjectStatus:n})}})},d=()=>{_({title:t("Docker.ComposeNew.index_21",[a.value.name]),content:t("Docker.ComposeNew.index_22"),onConfirm:()=>{de(a.value.name,{status:"restart",setProjectStatus:n})}})},p=()=>{_({title:t("Docker.ComposeNew.index_23",[a.value.name]),content:t("Docker.ComposeNew.index_24"),onConfirm:()=>{de(a.value.name,{status:"update",setProjectStatus:n})}})},m=()=>{_({title:t("Docker.ComposeNew.index_25",[a.value.name]),content:t("Docker.ComposeNew.index_26",[a.value.name]),onConfirm:({hide:e})=>{const{close:a}=l.loading(t("Docker.ComposeNew.index_27"));return n("delete",(t=>{o(t)&&-1===t.data&&(a(),t.status?(e(),s.value=0,c(),l.success(t.msg)):l.error(t.msg))})),!1}})};return(e,t)=>{const s=Y,l=ae,o=te;return y(),V(o,null,{default:B((()=>[P("div",je,[P("div",ye,[P("div",De,O(N(a).name),1),P("div",Se,[P("span",null,O(e.$t("Docker.ComposeNew.index_14",[N(r)(N(a).time)])),1),P("span",null,O(e.$t("Docker.ComposeNew.index_15",[N(a).container_count])),1)])]),J(l,null,{default:B((()=>["exited"===N(a).run_status?(y(),V(s,{key:0,onClick:i},{default:B((()=>[H(O(e.$t("Public.Status.Start")),1)])),_:1})):q("",!0),"running"===N(a).run_status?(y(),V(s,{key:1,onClick:u},{default:B((()=>[H(O(e.$t("Public.Status.Stop")),1)])),_:1})):q("",!0),"running"===N(a).run_status?(y(),V(s,{key:2,onClick:d},{default:B((()=>[H(O(e.$t("Public.Status.Restart")),1)])),_:1})):q("",!0),J(s,{onClick:p},{default:B((()=>[H(O(e.$t("Docker.ComposeNew.index_16")),1)])),_:1}),J(s,{class:"delete-btn",onClick:m},{default:B((()=>[H(O(e.$t("Public.Btn.Delete")),1)])),_:1})])),_:1})])])),_:1})}}}),[["__scopeId","data-v-ef472476"]]),Pe=w({__name:"main-container-status",props:{item:{}},emits:["select"],setup(e,{emit:t}){const a=t,s=z(e,"item"),{t:l}=U(),o=E((()=>{const e={text:l("Public.Status.Abnormal"),type:"warning"};switch(s.value.State){case"running":e.text=l("Public.Status.Running"),e.type="primary";break;case"exited":e.text=l("Public.Status.Stopped"),e.type="error"}return e})),n=E((()=>{switch(s.value.State){case"running":return[{label:l("Public.Status.Restart"),key:"restart"},{label:l("Public.Status.Stop"),key:"stop"},{label:l("Public.Status.Kill"),key:"kill"}];case"exited":return[{label:l("Public.Status.Start"),key:"start"}];default:return[{label:l("Public.Status.Restart"),key:"restart"},{label:l("Public.Status.Kill"),key:"kill"}]}})),c=e=>{a("select",e,s.value)};return(e,t)=>{const a=W,s=se;return y(),V(s,{options:N(n),onSelect:c},{default:B((()=>[J(a,{type:N(o).type,size:"small",class:"cursor-pointer"},{default:B((()=>[H(O(N(o).text),1)])),_:1},8,["type"])])),_:1},8,["options"])}}}),$e=w({__name:"index",props:{id:{}},setup(e){const t=z(e,"id"),s=C("");return(async()=>{const{message:e}=await(l={container_id:t.value},a.post("/mod/docker/com/get_project_container_logs",l));var l;o(e)&&(s.value=e.result)})(),(e,t)=>{const a=ne;return y(),V(a,{class:"h-480px",lang:"log","font-size":12,content:N(s)},null,8,["content"])}}}),Ie={class:"h-full overflow-auto"},Oe={key:0,class:"container-list"},Ae={class:"container-info"},Le={class:"flex items-center flex-1"},Re={class:"container-name"},ze={class:"ml-4px"},Ue={class:"ml-4px"},Ee=["title"],Je={key:0,class:"container-port"},Be={key:1,class:"flex-center h-full"},He=s(w({__name:"main-container",setup(e){const{t:t}=U(),{timestamp:a,currentProject:s,sendSocket:l}=ie(),o=C([]),r=async(e,t)=>{await i({id:t.ID,status:e})},{loading:d,setLoading:p}=v(),_=()=>{p(!0),l({mod_name:"docker",sub_mod_name:"com",def_name:"get_project_ps",path:s.value.path,ws_callback:"get_project_ps"},{action:"get_project_ps",callback:(e,t)=>{p(!1);const a=JSON.parse(t.data),{data:s}=a;u(s)&&(s.forEach((e=>{e.ports=e.Ports.split(",").filter((e=>""!==e))})),o.value=s)}})};return T((()=>s.value.path),(()=>{o.value=[]})),T((()=>a.value),(e=>{0!==e&&_()})),_(),(e,a)=>{const s=c,l=Y,i=W,u=Z,p=n,_=te;return y(),V(_,{class:"flex-1",title:e.$t("Docker.ComposeNew.index_29"),"content-style":{overflow:"hidden"}},{default:B((()=>[P("div",Ie,[J(p,{show:N(d),class:"h-full"},{default:B((()=>[N(o).length>0?(y(),j("div",Oe,[(y(!0),j(K,null,X(N(o),(a=>(y(),j("div",{key:a.ID,class:"container-item"},[P("div",Ae,[P("div",Le,[P("div",Re,O(a.Name),1),J(Pe,{item:a,onSelect:r},null,8,["item"])]),J(l,{onClick:e=>{var t;oe({id:(t=a).ID,status:t.State})}},{default:B((()=>[J(s,{name:"common-terminal",size:"13"}),P("span",ze,O(e.$t("Docker.ComposeNew.index_30")),1)])),_:2},1032,["onClick"]),J(l,{class:"ml-10px",onClick:e=>{var s;m({title:t("Docker.ComposeNew.index_32",[(s=a).Name]),width:720,data:{id:s.ID},component:$e})}},{default:B((()=>[J(s,{name:"base-record",size:"15"}),P("span",Ue,O(e.$t("Docker.ComposeNew.index_31")),1)])),_:2},1032,["onClick"])]),P("div",{class:"container-desc",title:a.ID},O(a.ID),9,Ee),a.ports&&a.ports.length>0?(y(),j("div",Je,[(y(!0),j(K,null,X(a.ports,(e=>(y(),V(i,{key:e,size:"small"},{default:B((()=>[H(O(e),1)])),_:2},1024)))),128))])):q("",!0)])))),128))])):(y(),j("div",Be,[J(u)]))])),_:1},8,["show"])])])),_:1},8,["title"])}}}),[["__scopeId","data-v-e8e8f2a1"]]),Ve={class:"p-16px h-full"},qe=w({__name:"main-logs",setup(e){const{timestamp:t,currentProject:a,sendSocket:s}=ie(),l=C(""),{loading:o,setLoading:n}=v(),c=()=>{n(!0),l.value="",s({mod_name:"docker",sub_mod_name:"com",def_name:"get_logs",path:a.value.path,ws_callback:"get_logs"},{action:"get_logs",callback:(e,t)=>{if(n(!1),t.data){const e=JSON.parse(t.data);l.value+=e.msg+"\n"}}})};return T((()=>t.value),(e=>{0!==e&&c()})),c(),(e,t)=>{const a=ne,s=te;return y(),V(s,{class:"h-55%",title:e.$t("Docker.ComposeNew.index_28"),"content-style":{overflow:"hidden"}},{default:B((()=>[P("div",Ve,[J(a,{class:"h-full",lang:"log",rows:80,"font-size":12,loading:N(o),content:N(l)},null,8,["loading","content"])])])),_:1},8,["title"])}}}),Me={class:"h-full p-16px"},Te={class:"flex items-center mb-10px"},Ke=["title"],Xe={class:"mt-16px"},Fe=s(w({__name:"main-config",setup(e){const t=F(),{t:a}=U(),{timestamp:s,currentProject:n,sendSocket:c,setProjectStatus:r}=ie(),i=C(""),u=C(""),p=()=>{d("Path",n.value.path),t.push("/files")},m=()=>{c({mod_name:"docker",sub_mod_name:"com",def_name:"get_config",path:n.value.path,ws_callback:"get_config"},{action:"get_config",callback:(e,t)=>{const a=JSON.parse(t.data).data;o(a)&&(i.value=a.config,u.value=a.env)}})};T((()=>s.value),(e=>{0!==e&&m()}));const v=()=>{_({title:a("Docker.ComposeNew.index_35"),content:a("Docker.ComposeNew.index_36"),onConfirm:({hide:e})=>{const{close:t}=l.loading(a("Docker.ComposeNew.index_37"));return c({mod_name:"docker",sub_mod_name:"com",def_name:"save_config",config:i.value,env:u.value,path:n.value.path,ws_callback:"save_config"},{action:"save_config",callback:(a,s)=>{t();const o=JSON.parse(s.data);o.status?(e(),de(n.value.name,{status:"restart",setProjectStatus:r})):l.error(o.msg)}}),!1}})};return m(),(e,t)=>{const a=Y,s=te;return y(),V(s,{title:e.$t("Docker.ComposeNew.index_33"),class:"w-42%"},{default:B((()=>[P("div",Me,[P("div",Te,[t[2]||(t[2]=P("span",{class:"text-14px mr-12px"},"compose.yaml",-1)),P("a",{href:"javascript:;",title:N(n).path,class:"jump-link",onClick:p},O(e.$t("Docker.ComposeNew.index_34")),9,Ke)]),J(ce,{value:N(i),"onUpdate:value":t[0]||(t[0]=e=>L(i)?i.value=e:null),"show-tips":!1,lang:"yaml",style:{height:"calc(100% - 370px)"}},null,8,["value"]),t[3]||(t[3]=P("div",{class:"flex items-center mt-16px mb-10px"},[P("span",{class:"text-14px"},".env")],-1)),J(ce,{value:N(u),"onUpdate:value":t[1]||(t[1]=e=>L(u)?u.value=e:null),height:"200","show-tips":!1},null,8,["value"]),P("div",Xe,[J(a,{type:"primary",onClick:v},{default:B((()=>[H(O(e.$t("Public.Btn.Save")),1)])),_:1})])])])),_:1},8,["title"])}}}),[["__scopeId","data-v-9c7767b0"]]),Ge={class:"flex-1 flex flex-col gap-16px overflow-hidden"},Qe={class:"flex-1 flex gap-16px overflow-hidden"},We={class:"flex-1 flex flex-col gap-16px overflow-hidden"},Ye={class:"flex-center flex-col h-full"},Ze=s(w({__name:"main",setup(e){const{loading:t,projectList:a,sendSocket:s,refreshCompose:l}=ie(),o=()=>{ue({send:s,refresh:l})};return(e,s)=>{const l=Z,c=p,r=n,i=te;return y(),j("div",Ge,[N(a).length>0?(y(),j(K,{key:0},[J(Ne),P("div",Qe,[P("div",We,[J(He),J(qe)]),J(Fe)])],64)):(y(),V(i,{key:1,class:"h-full"},{default:B((()=>[J(r,{show:N(t),class:"h-full"},{default:B((()=>[P("div",Ye,[J(l),J(c,{class:"mt-16px",onClick:o},{default:B((()=>[H(O(e.$t("Docker.ComposeNew.index_13")),1)])),_:1})])])),_:1},8,["show"])])),_:1}))])}}}),[["__scopeId","data-v-d7995fdc"]]),et=w({__name:"index",setup(e){const t=C(null),{height:a}=f(t),{send:s,close:l,open:o}=k("/ws_modsoc"),n=C([]),c=C([]),r=C(0),i=E((()=>n.value[r.value])),d=C(!1),p=C(0);let m=!1;const _=e=>{m=e},v=()=>{d.value=!0,s({mod_name:"docker",sub_mod_name:"com",def_name:"get_project_list",ws_callback:"get_project_list"},{action:"get_project_list",callback:(e,t)=>{d.value=!1;const a=JSON.parse(t.data);u(a.data)&&(n.value=a.data,c.value=a.data,m&&(p.value=Date.now(),_(!1)))}})};return v(),h(re,{loading:d,timestamp:p,projectList:n,projectListAll:c,projectActive:r,currentProject:i,sendSocket:s,setProjectStatus:(e,t)=>{s({mod_name:"docker",sub_mod_name:"com",def_name:e,path:i.value.path,project_name:i.value.name,ws_callback:e},{action:e,callback:(e,a)=>{const s=JSON.parse(a.data);t(s)}})},refreshCompose:()=>{l(),o(),_(!0),v()}}),(e,s)=>(y(),j("div",{ref_key:"composeRef",ref:t,class:"flex",style:G({height:N(a)})},[J(be),J(Ze)],4))}});export{et as default};


