import{b as e,c as a,f as l}from"./public.js?v=1752142539265";import{_ as t,d as s,X as n}from"./page_layout.js?v=1752142539265";import{a as i}from"./file.js?v=1752142539265";import{_ as o,c2 as c,bR as r,ay as d,bX as p,d0 as u}from"./naive.js?v=1752142539265";import{k as m,P as f,r as v,Q as x,U as h,X as k,V as y,a2 as _,j as b,a3 as C,W as g,F as w,O as P}from"./vue.js?v=1752142539265";import"./common.js?v=1752142539265";import"./__commonjsHelpers__.js?v=1752142539265";const j={class:"flex flex-col h-full"},S={class:"flex-1 w-0 truncate"},z={class:"flex flex-1 overflow-hidden"},D={class:"w-160px py-12px overflow-auto"},I=["onClick"],E={class:"flex-1 ml-8px"},X={class:"flex-1","b-l":"1 solid #aaa"},F=m({__name:"index",props:{data:{}},setup(m,{expose:F}){const{t:H}=f(),L=m,{path:O,checkedType:R,callback:T}=L.data,U=v([]),$=v([]),A=v(O||"/"),{table:K,columns:Q}=e([{key:"checkbox",title:"",width:36,render:e=>R.includes(e.type)?x("div",{onClick:e=>{e.stopPropagation()}},[x(o,{checked:e.filename===$.value[0],onUpdateChecked:a=>{$.value=a?[e.filename]:[]}},null)]):""},{key:"filename",title:H("Component.SelectPath.index_3"),render:e=>x("div",{class:"flex"},[x("div",{class:"flex items-center flex-1 cursor-pointer",onClick:a=>{"dir"===e.type&&(a.preventDefault(),A.value+="".concat("/"===A.value?"":"/").concat(e.filename),G(),a.stopPropagation())}},[x("div",null,["dir"===e.type?x(t,{name:"base-dir",size:"16"},null):"","file"===e.type?x(t,{name:"base-file",size:"16",color:"#666"},null):""]),x("div",{class:"ml-6px flex-1 w-0"},[x(c,null,{default:()=>[e.filename]})])])])},{key:"time",title:H("Component.SelectPath.index_4"),width:146},{key:"permission",title:H("Component.SelectPath.index_5"),width:86},{key:"owner",title:H("Component.SelectPath.index_6"),width:72}]),V=e=>({onClick:()=>{if(R.includes(e.type)){const a=u($.value,(a=>a===e.filename));$.value=-1!==a?[]:[e.filename]}},onDblclick:()=>{R.includes(e.type)&&(A.value+="".concat("/"===A.value?"":"/").concat(e.filename),G())}}),W=()=>{const e=A.value.substring(0,A.value.lastIndexOf("/"));A.value=""===e?"/":e,G()},{loading:q,setLoading:B}=a(),G=async()=>{try{B(!0),K.data=[],$.value=[];const{message:e}=await i({path:A.value});if(s(e)){const a=[],l=r(e,"DIR",[]),t=r(e,"FILES",[]);l.forEach((e=>{a.push(J(e,"dir"))})),t.forEach((e=>{a.push(J(e,"file"))})),A.value=e.PATH,K.data=a,U.value=r(e,"DISK",[])}}finally{B(!1)}},J=(e,a)=>{const l=e.split(";"),t=l[0],s=n(l[2]),i=l[3],o=l[4];return{path:("/"!==A.value?A.value+"/":"")+t,filename:t,time:s,permission:i,owner:o,type:a}};return G(),F({onConfirm:({hide:e})=>{const a=$.value.length>0?$.value[0]:"",l=("/"!==A.value?A.value+"/":"")+a,t=K.data.find((e=>e.filename===a));null==T||T(l,t),e()}}),(e,a)=>{const s=d,n=p,i=l;return k(),h("div",j,[x(n,{class:"items-center h-50px px-12px","b-b":"1 solid #aaa"},{default:_((()=>[x(s,{onClick:W},{default:_((()=>[b(C(e.$t("Component.SelectPath.index_1")),1)])),_:1}),y("div",S,C(e.$t("Component.SelectPath.index_2"))+": "+C(g(A)),1)])),_:1}),y("div",z,[y("div",D,[(k(!0),h(w,null,P(g(U),(e=>(k(),h("div",{key:e.path,class:"flex items-center p-8px pl-16px hover:bg-#ececec cursor-pointer transition-colors",onClick:a=>{return l=e.path,A.value=l,void G();var l}},[x(t,{name:"file-disk",size:"18",color:"#666"}),y("div",E,C(e.path)+" "+C(e.size[2]?"(".concat(e.size[2],")"):""),1)],8,I)))),128))]),y("div",X,[x(i,{loading:g(q),"loading-num":10,bordered:!1,"virtual-scroll":!0,"max-height":456,data:g(K).data,columns:g(Q),"row-props":V},null,8,["loading","data","columns"])])])])}}});export{F as default};
